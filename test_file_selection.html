<!DOCTYPE html>
<html>
<head>
    <title>File Selection Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .test-container { border: 1px solid #ccc; padding: 20px; margin: 20px 0; }
        .status { margin: 10px 0; padding: 10px; background: #f5f5f5; }
    </style>
</head>
<body>
    <h1>File Selection Test</h1>
    
    <div class="test-container">
        <h3>Test 1: Basic File Input</h3>
        <input type="file" id="test1" accept=".csv,.xlsx,.json" />
        <div id="status1" class="status">No file selected</div>
    </div>
    
    <div class="test-container">
        <h3>Test 2: File Input with Change Handler</h3>
        <input type="file" id="test2" accept=".csv,.xlsx,.json" />
        <div id="status2" class="status">No file selected</div>
        <button onclick="processFile()">Process File</button>
    </div>
    
    <div class="test-container">
        <h3>Console Logs</h3>
        <div id="logs" class="status" style="height: 200px; overflow-y: auto;"></div>
    </div>

    <script>
        function log(message) {
            console.log(message);
            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }
        
        document.getElementById('test1').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const status = document.getElementById('status1');
            
            log('Test 1 - File change event triggered');
            log('Test 1 - Files array: ' + JSON.stringify(Array.from(e.target.files || [])));
            
            if (file) {
                log('Test 1 - File selected: ' + file.name + ' (' + file.size + ' bytes)');
                status.innerHTML = 'Selected: ' + file.name + ' (' + Math.round(file.size/1024) + ' KB)';
                status.style.background = '#d4edda';
            } else {
                log('Test 1 - No file selected');
                status.innerHTML = 'No file selected';
                status.style.background = '#f8d7da';
            }
        });
        
        document.getElementById('test2').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const status = document.getElementById('status2');
            
            log('Test 2 - File change event triggered');
            log('Test 2 - Files array: ' + JSON.stringify(Array.from(e.target.files || [])));
            
            if (file) {
                log('Test 2 - File selected: ' + file.name + ' (' + file.size + ' bytes)');
                status.innerHTML = 'Selected: ' + file.name + ' (' + Math.round(file.size/1024) + ' KB)';
                status.style.background = '#d4edda';
            } else {
                log('Test 2 - No file selected');
                status.innerHTML = 'No file selected';
                status.style.background = '#f8d7da';
            }
        });
        
        function processFile() {
            const fileInput = document.getElementById('test2');
            const file = fileInput.files[0];
            
            log('Process button clicked');
            log('File input value: ' + fileInput.value);
            log('Files length: ' + (fileInput.files ? fileInput.files.length : 0));
            
            if (file) {
                log('Processing file: ' + file.name);
                alert('File ready for processing: ' + file.name);
            } else {
                log('No file to process');
                alert('No file selected for processing');
            }
        }
        
        // Browser compatibility check
        log('Browser compatibility check:');
        log('FileReader support: ' + (typeof FileReader !== 'undefined'));
        log('File API support: ' + !!(window.File && window.FileReader && window.FileList && window.Blob));
        log('User agent: ' + navigator.userAgent);
    </script>
</body>
</html>
